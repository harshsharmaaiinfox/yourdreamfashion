import{Ac as L,Bc as R,Cc as U,Dc as $,Fa as b,ba as p,r as s,s as S,u as l,xc as j,yc as x,zc as I}from"./chunk-3ZISJ7VE.js";import{Bc as f,Rc as k,Y as i,a as h,b as y,ca as c,fa as n,m as o}from"./chunk-37HN4E3D.js";var E=(()=>{class a{constructor(e){this.http=e,this.skeletonLoader=!1}getOrders(e){return this.http.get(`${p.URL}/order`,{params:e})}viewOrder(e){return this.http.get(`${p.URL}/order/${e}`)}checkout(e){return this.http.post(`${p.URL}/checkout`,e)}placeOrder(e){return this.http.post(`${p.URL}/order`,e)}rePayment(e){return this.http.post(`${p.URL}/rePayment`,e)}orderTracking(e){return this.http.get(`${p.URL}/trackOrder`,{params:e})}downloadInvoice(e){let t={};return this.http.post(`${p.URL}/order/invoice`,e,{responseType:"blob"})}static{this.\u0275fac=function(t){return new(t||a)(n(f))}}static{this.\u0275prov=c({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})();var d=class w{constructor(r,e,t){this.notificationService=r,this.router=e,this.orderService=t}static order(r){return r.order}static selectedOrder(r){return r.selectedOrder}static checkout(r){return r.checkout}getOrders(r,e){return this.orderService.getOrders(e?.payload).pipe(i({next:t=>{r.patchState({order:{data:t.data,total:t?.total?t?.total:t.data?.length}})},error:t=>{throw new Error(t?.error?.message)}}))}viewOrder(r,{id:e}){return this.orderService.skeletonLoader=!0,this.orderService.viewOrder(e).pipe(i({next:t=>{let m=r.getState();r.patchState(y(h({},m),{selectedOrder:t}))},error:t=>{throw new Error(t?.error?.message)},complete:()=>{this.orderService.skeletonLoader=!1}}))}checkout(r,e){return this.orderService.checkout(e?.payload).pipe(i({next:t=>{let m=r.getState();r.patchState(y(h({},m),{checkout:t}))},error:t=>{throw new Error(t?.error?.message)}}))}placeOrder(r,e){return this.orderService.placeOrder(e?.payload).pipe(i({next:t=>{(e.payload.payment_method=="cod"||e.payload.payment_method=="cash_free"||e.payload.payment_method=="sub_paisa"||e.payload.payment_method=="zyaada_pay"||e.payload.payment_method=="bank_transfer"||e.payload.payment_method=="fashionwithtrends_neokred"||e.payload.payment_method=="gaonvashi_cashfree")&&!t.is_guest?(this.router.navigateByUrl(`/account/order/details/${t.order_number}`),setTimeout(()=>{window.location.reload()},1e3)):(e.payload.payment_method=="cod"||e.payload.payment_method=="cash_free"||e.payload.payment_method=="sub_paisa"||e.payload.payment_method=="zyaada_pay"||e.payload.payment_method=="bank_transfer"||e.payload.payment_method=="fashionwithtrends_neokred"||e.payload.payment_method=="gaonvashi_cashfree")&&t.is_guest?(this.router.navigate(["order/details"],{queryParams:{order_number:t.order_number,email_or_phone:e?.payload.email}}),setTimeout(()=>{window.location.reload()},1e3)):window.open(t.url,"_self")},error:t=>{throw new Error(t?.error?.message)}}))}rePayment(r,e){return this.orderService.rePayment(e.payload).pipe(i({next:t=>{(e.payload.payment_method=="cod"||e.payload.payment_method=="bank_transfer")&&!t.is_guest?this.router.navigateByUrl(`/account/order/details/${t.order_number}`):(e.payload.payment_method=="cod"||e.payload.payment_method=="bank_transfer")&&t.is_guest?this.router.navigate(["order/details"],{queryParams:{order_number:t.order_number,email_or_phone:t.email}}):window.open(t.url,"_self")},error:t=>{throw new Error(t?.error?.message)}}))}orderTracking(r,e){return this.notificationService.notification=!1,this.orderService.orderTracking(e.payload).pipe(i({next:t=>{let m=r.getState();r.patchState(y(h({},m),{selectedOrder:t}))},error:t=>{throw new Error(t?.error?.message)}}))}downloadInvoice(r,e){return this.orderService.downloadInvoice(e.payload).pipe(i({next:t=>{let m=new Blob([t],{type:"pdf"}),g=window.URL.createObjectURL(m),v=document.createElement("a");v.href=g,v.download=`invoice-${e.payload.order_number}.pdf`,v.click(),window.URL.revokeObjectURL(g)},error:t=>{throw new Error(t?.error?.message)}}))}static{this.\u0275fac=function(e){return new(e||w)(n(b),n(k),n(E))}}static{this.\u0275prov=c({token:w,factory:w.\u0275fac})}};o([s(j)],d.prototype,"getOrders",null);o([s(x)],d.prototype,"viewOrder",null);o([s(I)],d.prototype,"checkout",null);o([s(L)],d.prototype,"placeOrder",null);o([s(R)],d.prototype,"rePayment",null);o([s(U)],d.prototype,"orderTracking",null);o([s($)],d.prototype,"downloadInvoice",null);o([l()],d,"order",null);o([l()],d,"selectedOrder",null);o([l()],d,"checkout",null);d=o([S({name:"order",defaults:{order:{data:[],total:0},selectedOrder:null,checkout:null}})],d);var P=(()=>{class a{static{this.type="[Order Status] Get"}constructor(e){this.payload=e}}return a})();var T=(()=>{class a{constructor(e){this.http=e}getOrderStatus(e){return this.http.get(`${p.URL}/orderStatus`,{params:e})}static{this.\u0275fac=function(t){return new(t||a)(n(f))}}static{this.\u0275prov=c({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})();var u=class _{constructor(r){this.orderStatusService=r}static orderStatus(r){return r.orderStatus}static orderStatuses(r){return r.orderStatus.data.map(e=>({label:e?.name,value:e?.id}))}static selectedOrderStatus(r){return r.selectedOrderStatus}getOrderStatus(r,e){return this.orderStatusService.getOrderStatus(e.payload).pipe(i({next:t=>{r.patchState({orderStatus:{data:t.data,total:t?.total?t?.total:t.data?.length}})},error:t=>{throw new Error(t?.error?.message)}}))}static{this.\u0275fac=function(e){return new(e||_)(n(T))}}static{this.\u0275prov=c({token:_,factory:_.\u0275fac})}};o([s(P)],u.prototype,"getOrderStatus",null);o([l()],u,"orderStatus",null);o([l()],u,"orderStatuses",null);o([l()],u,"selectedOrderStatus",null);u=o([S({name:"orderStatus",defaults:{orderStatus:{data:[],total:0},selectedOrderStatus:null}})],u);export{E as a,d as b,P as c,u as d};
